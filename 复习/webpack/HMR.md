参考资料:[源码解析（看不明白）](https://juejin.cn/post/6844904008432222215#heading-11)

+ Webpack热更新（ Hot Module Replacement，简称 HMR，后续均以 HMR 替代），无需完全刷新整个页面的同时，更新所有类型的模块，是 Webpack 提供的最有用的功能之一。
+ 保留在完全重新加载页面期间丢失的应用程序状态。
+ 只更新变更内容，以节省宝贵的开发时间。
+ 在源代码中对 CSS / JS 进行修改，会立刻在浏览器中进行更新，这几乎相当于在浏览器 devtools 直接更改样式。





### 过程

+ 第一次渲染（在第一次打包时，会插入`websocket`让浏览器和服务端建立连接，并且会建立一个watcher通过监听文件的生成时间来监听文件的变化）
+ 修改文件（文件受到修改，wacther监听到）
+ watcher监听到后会重新打包该文件
+ 打包完成后，通过websocket告知客户端文件发生了变化
+ 客户端收到通知后，发请求获取变化文件的hash
+ 获取到hash后，通过JSONP方式请求新文件（因为这样可以直接执行）
+ 获取到文件后，删除过期模块，添加新模块，执行新文件



### webpack默认为哪些文件会设置HMR
+ css文件：因为css-loder内部实现了HMR
+ js文件默认没有HMR文件，需要修改js代码增加HMR功能；HMR只能处理非入口文件的js文件
+ html文件：默认没有HMR功能，可以添加入口文件来添加HMR功能；但是一般来说应用常为spa，就一个html文件，一个模块通常会直接改变不需要HMR功能